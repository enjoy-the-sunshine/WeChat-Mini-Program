<view class="page">

<!-- 第一块：体内咖啡因 -->
<view class="section-title">体内咖啡因代谢实时预测</view>
<view class="time-interval-selector">
  <text class="interval-label">时间间隔</text>
  <view class="interval-options">
    <view class="interval-option {{timeInterval === 2 ? 'active' : ''}}" bindtap="setTimeInterval" data-interval="2">2小时</view>
    <view class="interval-option {{timeInterval === 4 ? 'active' : ''}}" bindtap="setTimeInterval" data-interval="4">4小时</view>
    <view class="interval-option {{timeInterval === 6 ? 'active' : ''}}" bindtap="setTimeInterval" data-interval="6">6小时</view>
    <view class="interval-option {{timeInterval === 8 ? 'active' : ''}}" bindtap="setTimeInterval" data-interval="8">8小时</view>
  </view>
</view>

<!-- 图表卡片 1：使用 chart-wrap 让画布上下左右居中；高度/位移走数据绑定 -->
<view class="card chart-card">
  <view class="chart-wrap" style="padding-top: {{wrapPadTop1}}rpx;">
    <ec-canvas
      id="chart1"
      canvas-id="chart1-canvas"
      class="chart-canvas"
      style="height: 483rpx; transform: translateY({{chartOffset1}}rpx); display: block; box-sizing: border-box"
      ec="{{ ec1 }}"
    ></ec-canvas>
  </view>
</view>

<!-- 第二块：测试咖啡因 -->
<view class="section-title">测试咖啡因代谢预测</view>

<view wx:if="{{hasTestDrink}}" class="time-interval-selector">
  <text class="interval-label">时间间隔</text>
  <view class="interval-options">
    <view class="interval-option {{testTimeInterval === 2 ? 'active' : ''}}" bindtap="setTestTimeInterval" data-interval="2">2小时</view>
    <view class="interval-option {{testTimeInterval === 4 ? 'active' : ''}}" bindtap="setTestTimeInterval" data-interval="4">4小时</view>
    <view class="interval-option {{testTimeInterval === 6 ? 'active' : ''}}" bindtap="setTestTimeInterval" data-interval="6">6小时</view>
    <view class="interval-option {{testTimeInterval === 8 ? 'active' : ''}}" bindtap="setTestTimeInterval" data-interval="8">8小时</view>
  </view>
</view>

<!-- 空态与图表互斥，二选一 -->
<view class="card chart-card">
  <block wx:if="{{!hasTestDrink}}">
    <view class="empty-test-card">
      <view class="empty-icon">☕</view>
      <view class="empty-text">暂无测试饮品</view>
      <view class="empty-desc">添加测试饮品查看预测效果</view>
    </view>
  </block>
  <block wx:else>
    <view class="chart-wrap" style="padding-top: {{wrapPadTop2}}rpx;">
      <ec-canvas
        id="chart2"
        canvas-id="chart2-canvas"
        class="chart-canvas"
        style="height: {{chartH2}}rpx; transform: translateY({{chartOffset2}}rpx);"
        ec="{{ ec2 }}"
      ></ec-canvas>
    </view>
  </block>
</view>

<!-- 第三块：添加按钮 -->
<view class="action-btn" bindtap="addTestDrink">
  <text class="plus">+</text>
  <text class="label">添加测试饮品</text>
  <text class="arrow">></text>
</view>

</view>
