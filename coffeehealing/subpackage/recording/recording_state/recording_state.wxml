<view class="page">
  <!-- 今日心情 -->
  <view class="panel panel-white panel-mood">
    <view class="panel-header">
      <text class="h2">今日心情</text>
    </view>

    <view class="mood-container">
      <!-- 左侧：大图 + 文字 -->
      <view class="mood-hero">
        <image class="hero-img" src="{{moodBigMap[mood].src}}" mode="aspectFit" />
        <text class="hero-text">{{moodBigMap[mood].text}}</text>
      </view>

      <!-- 右侧：心情选择网格 -->
      <view class="mood-grid">
        <block wx:for="{{moodList}}" wx:key="id">
          <view class="mood-item {{mood===item.id?'active':''}}" bindtap="onPickMood" data-id="{{item.id}}">
            <image class="mood-img" src="{{item.src}}" mode="aspectFit"></image>
          </view>
        </block>
      </view>
    </view>
  </view>

  <!-- 睡眠记录 -->
  <view class="panel panel-sleep">
    <view class="panel-header">
      <view class="h2-row">
        <text class="h2">睡眠记录</text>
        <image class="head-icon" src="{{icons.mooncloud}}" mode="widthFix" />
      </view>
    </view>

    <view class="sleep-content">
      <!-- 第1行：入睡时间 / 睡眠时长 -->
      <view class="kv-row">
        <view class="kv-box">
          <view class="kv-title">
            <image class="kv-icon" src="{{icons.moon}}" mode="widthFix" />
            <text>入睡时间</text>
          </view>
          <picker mode="time" value="{{sleepTime}}" start="00:00" end="23:59" bindchange="onChangeTime">
            <view class="kv-value">{{sleepTime}}  ＞</view>
          </picker>
        </view>

        <view class="kv-box duration-box">
          <view class="kv-title">
            <image class="kv-icon" src="{{icons.clock}}" mode="widthFix" />
            <text>睡眠时长</text>
          </view>
          <view class="kv-value duration-text">{{durationText}}</view>
          
          <view class="arrow-container">
            <image class="arrow-btn arrow-up" src="{{icons.up}}" mode="widthFix" bindtap="tapIncDuration" />
            <image class="arrow-btn arrow-down" src="{{icons.down}}" mode="widthFix" bindtap="tapDecDuration" />
          </view>
        </view>
      </view>

      <!-- 第2行：效率 / 评分 -->
      <view class="kv-row">
        <view class="kv-box">
          <view class="kv-title">
            <image class="kv-icon" src="{{icons.star}}" mode="widthFix" />
            <text>睡眠效率</text>
          </view>
          <view class="kv-value">{{sleepEfficiency}}%</view>
          <slider class="kv-slider" min="50" max="100" step="1" value="{{sleepEfficiency}}" 
                  bindchange="onChangeEfficiency" block-size="10" activeColor="#A1CAE2" />
        </view>

        <view class="kv-box">
          <view class="kv-title">
            <image class="kv-icon" src="{{icons.like}}" mode="widthFix" />
            <text>睡眠评分</text>
          </view>
          <view class="kv-value">{{sleepScore}}分</view>
          <slider class="kv-slider" min="0" max="100" step="1" value="{{sleepScore}}" 
                  bindchange="onChangeScore" block-size="10" activeColor="#A1CAE2" />
        </view>
      </view>

      <!-- 睡眠感受 -->
      <view class="feel-wrap">
        <text class="feel-label">睡眠感受</text>
        <view class="feel-group">
          <block wx:for="{{feelList}}" wx:key="id">
            <view class="feel-item {{feel===item.id?'sel':''}}" bindtap="onPickFeel" data-id="{{item.id}}">
              <image class="feel-img" src="{{item.src}}" mode="aspectFit"></image>
            </view>
          </block>
        </view>
      </view>
    </view>
  </view>

  <!-- 元气熊日志 -->
  <view class="panel panel-white panel-journal">
    <view class="panel-header">
      <text class="h2">元气熊の日志</text>
    </view>

    <view class="journal">
      <image class="bear" src="{{images.bearDiary}}" mode="widthFix" />
      <view class="note-box">
        <image class="paperclip" src="{{icons.paperclip}}" mode="widthFix" />
        <textarea class="note" placeholder="记录美好生活呀！" maxlength="300"
                  value="{{note}}" bindinput="onInputNote"/>
        <image class="pen" src="{{icons.pen}}" mode="widthFix" />
      </view>
    </view>
  </view>

  <!-- 确认按钮 -->
  <view class="footer">
    <view class="btn-primary" hover-class="btn-primary--active" bindtap="onSubmit">确认</view>
  </view>
</view>
