<view class="page">
  <!-- цЭпхЮЛщАЙцЛй -->
  <view class="section cups-section">
    <view class="section-title">
      <view class="title-icon">тШХ</view>
      <text>щАЙцЛйцЭпхЮЛ</text>
    </view>
    <view class="cups">
      <view class="cup-item {{cupSize === 'хдзцЭп' ? 'selected' : ''}}" data-size="хдзцЭп" bindtap="selectCup">
        <view class="cup-image-wrapper">
          <image src="../images/cup-large.png" class="cup-img"></image>
          <view class="selection-badge" wx:if="{{cupSize === 'хдзцЭп'}}">тЬУ</view>
        </view>
        <text class="cup-text">хдзцЭп</text>
        <text class="cup-volume">350ml</text>
        <view class="cup-add-btn" data-size="хдзцЭп" bindtap="showInputModal">
          <image src="../images/add-icon.png" class="add-icon"></image>
        </view>
      </view>
      <view class="cup-item {{cupSize === 'ф╕нцЭп' ? 'selected' : ''}}" data-size="ф╕нцЭп" bindtap="selectCup">
        <view class="cup-image-wrapper">
          <image src="../images/cup-medium.png" class="cup-img"></image>
          <view class="selection-badge" wx:if="{{cupSize === 'ф╕нцЭп'}}">тЬУ</view>
        </view>
        <text class="cup-text">ф╕нцЭп</text>
        <text class="cup-volume">250ml</text>
        <view class="cup-add-btn" data-size="ф╕нцЭп" bindtap="showInputModal">
          <image src="../images/add-icon.png" class="add-icon"></image>
        </view>
      </view>
      <view class="cup-item {{cupSize === 'х░ПцЭп' ? 'selected' : ''}}" data-size="х░ПцЭп" bindtap="selectCup">
        <view class="cup-image-wrapper">
          <image src="../images/cup-small.png" class="cup-img"></image>
          <view class="selection-badge" wx:if="{{cupSize === 'х░ПцЭп'}}">тЬУ</view>
        </view>
        <text class="cup-text">х░ПцЭп</text>
        <text class="cup-volume">150ml</text>
        <view class="cup-add-btn" data-size="х░ПцЭп" bindtap="showInputModal">
          <image src="../images/add-icon.png" class="add-icon"></image>
        </view>
      </view>
    </view>
  </view>

  <!-- щеочФицЧ╢щЧ┤ -->
  <view class="section time-section">
    <view class="section-title">
      <view class="title-icon">ЁЯХР</view>
      <text>щеочФицЧ╢щЧ┤</text>
    </view>
    <view class="time-card">
      <view class="time-left">
        <image src="../images/time2.png" class="time-illustration"></image>
        <view class="time-info">
          <text class="time-label">х╜УхЙНщАЙцЛй</text>
          <text class="time-subtitle">шо░х╜ХцВичЪДщеочФицЧ╢щЧ┤</text>
        </view>
      </view>
      <view class="time-right">
        <picker mode="time" value="{{drinkTime}}" start="00:00" end="23:59" bindchange="onTimeChange">
          <view class="time-picker">
            <view class="time-display">
              <text class="time-value">{{drinkTime || 'чВ╣хЗ╗щАЙцЛй'}}</text>
              <view class="time-arrow">тЦ╝</view>
            </view>
            <view class="time-hint">щАЙцЛйцЧ╢щЧ┤</view>
          </view>
        </picker>
      </view>
    </view>
  </view>

  <!-- хТЦхХбхЫахРлщЗП -->
  <view class="section caffeine-section">
    <view class="section-title">
      <view class="title-icon">тЪб</view>
      <text>хТЦхХбхЫахРлщЗП</text>
    </view>
    <view class="caffeine-card">
      <view class="caffeine-left">
        <image src="../images/caffeine2.png" class="caffeine-illustration"></image>
        <view class="caffeine-info">
          <text class="caffeine-label">щвДшобцСДхЕещЗП</text>
          <text class="caffeine-subtitle">хЯ║ф║ОцаЗхЗЖщЕНцЦ╣шобчоЧ</text>
        </view>
      </view>
      <view class="caffeine-right">
        <view class="caffeine-display">
          <view class="caffeine-amount">
            <text class="caffeine-value">{{caffeineAmount || '--'}}</text>
            <text class="caffeine-unit">mg</text>
          </view>
          <view class="caffeine-bar">
            <view class="bar-track">
              <view class="bar-fill" style="width: {{cupSize ? '100%' : '0%'}}"></view>
            </view>
            <text class="bar-text">{{cupSize ? 'х╖▓щАЙцЛй' : 'цЬкщАЙцЛй'}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- ц╖╗хКацМЙщТо -->
  <view class="action-section">
    <button class="add-btn {{cupSize ? 'active' : 'disabled'}}" bindtap="goBackToCaffeine" disabled="{{!cupSize}}">
      <view class="btn-content">
        <text class="btn-text">чбошодц╖╗хКа</text>
        <view class="btn-icon">тЬУ</view>
      </view>
    </button>
  </view>

  <!-- ш╛УхЕещеочФищЗПх╝╣чкЧ -->
  <view wx:if="{{showModal}}" class="modal-mask">
    <view class="modal-container">
      <view class="modal-header">
        <view class="modal-title-wrapper">
          <text class="modal-title">шо╛ч╜ощеочФищЗП</text>
          <text class="modal-subtitle">ф╕║ {{currentCup}} шо╛ч╜охоЮщЩЕщеочФищЗП</text>
        </view>
        <view class="modal-close" bindtap="closeModal">
          <image src="../images/close-icon.png" class="close-icon"></image>
        </view>
      </view>
      <view class="modal-body">
        <view class="input-section">
          <text class="input-label">щеочФищЗПчЩ╛хИЖцпФ</text>
          <view class="input-wrapper">
            <input type="number" bindinput="onAmountInput" class="modal-input" placeholder="0" value="{{amount}}" maxlength="3"/>
            <text class="input-unit">%</text>
          </view>
          <view class="input-slider">
            <slider min="0" max="100" value="{{amount}}" activeColor="#D2691E" backgroundColor="#f0f0f0" block-size="24" block-color="#D2691E" bindchange="onSliderInput" bindchanging="onSliderInput"/>
            <text class="slider-value">{{amount || 0}}%</text>
          </view>
        </view>
      </view>
      <view class="modal-actions">
        <button class="modal-cancel" bindtap="closeModal">хПЦц╢И</button>
        <button class="modal-confirm" bindtap="confirmAmount">чбохоЪ</button>
      </view>
    </view>
  </view>
</view>
