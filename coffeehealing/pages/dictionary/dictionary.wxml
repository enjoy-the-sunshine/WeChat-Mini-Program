<!--pages/add_home/add_home.wxml-->
<view class="container" style="height: 1231rpx; display: flex; box-sizing: border-box">
  <view class="main-content">
    <!-- å·¦ä¾§ä¾§è¾¹æ  -->
    <view class="sidebar">
      <view class="sidebar-item {{currentCategory === 'recent' ? 'active' : ''}}" 
            bindtap="switchCategory" data-category="recent">
        <view class="sidebar-icon">ğŸ“…</view>
        <text class="sidebar-text">æœ€è¿‘</text>
      </view>
      
      <view class="sidebar-item {{currentCategory === 'favorite' ? 'active' : ''}}" 
            bindtap="switchCategory" data-category="favorite">
        <view class="sidebar-icon">â­</view>
        <text class="sidebar-text">æ”¶è—</text>
      </view>
      
      <view class="sidebar-item {{currentCategory === 'custom' ? 'active' : ''}}" 
            bindtap="switchCategory" data-category="custom">
        <view class="sidebar-icon">âš™ï¸</view>
        <text class="sidebar-text">è‡ªå®šä¹‰</text>
      </view>

      <!-- å“ç‰Œåˆ—è¡¨ -->
      <view class="brand-separator">
        <text class="separator-text">å“ç‰Œ</text>
      </view>
      
      <view wx:for="{{brands}}" wx:key="id" 
            class="sidebar-item {{currentCategory === item.id ? 'active' : ''}}" 
            bindtap="switchCategory" data-category="{{item.id}}">
        <view class="brand-logo">{{item.emoji || 'â˜•'}}</view>
        <text class="sidebar-text">{{item.name}}</text>
      </view>
    </view>

    <!-- å³ä¾§é¥®å“åˆ—è¡¨ -->
    <view class="drink-list">
      <!-- è‡ªå®šä¹‰å’–å•¡æŒ‰é’® -->
      <view class="custom-add-btn" bindtap="showCustomAddModal" style="position: relative; left: 5rpx; top: -8rpx; width: 500rpx; display: flex; box-sizing: border-box">
        <text class="custom-add-icon">+</text>
        <text class="custom-add-text">è‡ªå®šä¹‰å’–å•¡</text>
      </view>
      
      <view class="category-title">
        <text>{{currentCategoryTitle}}</text>
      </view>
      
      <view wx:for="{{currentDrinks}}" wx:key="id" 
            class="drink-item" bindtap="selectDrink" data-drink="{{item}}">
        <view class="drink-icon">{{item.emoji || 'â˜•'}}</view>
        <view class="drink-info">
          <text class="drink-name">{{item.name}}</text>
          <text class="drink-caffeine">{{item.caffeine}} mg{{item.unit || ''}}</text>
        </view>
        <view class="drink-actions">
          <view class="favorite-btn {{item.isFavorite ? 'favorited' : ''}}" 
                catchtap="toggleFavorite" data-drink-id="{{item.id}}">
            <text class="favorite-icon">{{item.isFavorite ? 'â˜…' : 'â˜†'}}</text>
          </view>
          <!-- è‡ªå®šä¹‰é¥®å“åˆ é™¤æŒ‰é’® -->
          <view wx:if="{{currentCategory === 'custom' && item.isCustom}}" 
                class="delete-btn" catchtap="deleteCustomDrink" data-drink-id="{{item.id}}">
            <text class="delete-icon">ğŸ—‘ï¸</text>
          </view>
        </view>
      </view>

      <!-- ç©ºçŠ¶æ€ -->
      <view wx:if="{{currentDrinks.length === 0}}" class="empty-state">
        <view class="empty-icon">ğŸ“­</view>
        <text class="empty-text">æš‚æ— é¥®å“æ•°æ®</text>
      </view>
    </view>
  </view>
</view>

<!-- è‡ªå®šä¹‰å’–å•¡å¼¹çª— -->
<view class="modal-overlay {{showCustomModal ? 'show' : ''}}" bindtap="hideCustomModal">
  <view class="modal-content" catchtap="stopPropagation" style="position: relative; ">
    <view class="modal-header">
      <text class="modal-title">æ·»åŠ è‡ªå®šä¹‰å’–å•¡</text>
      <view class="modal-close" bindtap="hideCustomModal">Ã—</view>
    </view>
    
    <view class="modal-body">
      <view class="form-item" style="width: 500rpx; display: block; box-sizing: border-box">
        <text class="form-label">é¥®å“åç§°</text>
        <input class="form-input" placeholder="è¯·è¾“å…¥é¥®å“åç§°" 
               value="{{customDrink.name}}" bindinput="onCustomNameInput"/>
      </view>
      
      <view class="form-item"style="width: 500rpx; display: block; box-sizing: border-box">
        <text class="form-label">å’–å•¡å› å«é‡ (mg)</text>
        <input class="form-input" type="number" placeholder="è¯·è¾“å…¥å’–å•¡å› å«é‡" 
               value="{{customDrink.caffeine}}" bindinput="onCustomCaffeineInput"/>
      </view>
      
      <view class="form-item"style="width: 500rpx; display: block; box-sizing: border-box">
        <text class="form-label">å•ä½</text>
        <picker class="form-picker" range="{{unitOptions}}" 
                value="{{customDrink.unitIndex}}" bindchange="onUnitChange">
          <view class="picker-text">{{unitOptions[customDrink.unitIndex]}}</view>
        </picker>
      </view>
    </view>
    
    <view class="modal-footer">
      <button class="btn-cancel" bindtap="hideCustomModal">å–æ¶ˆ</button>
      <button class="btn-confirm" bindtap="addCustomDrink">ç¡®å®š</button>
    </view>
  </view>
</view>
